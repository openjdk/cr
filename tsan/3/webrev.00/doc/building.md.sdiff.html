<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff doc/building.md</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center><a href="building.html.sdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="testing.html.sdiff.html" target="_top">next &gt;</a></center>    <h2>doc/building.md</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 103 complete a build at all.
 104 
 105 We *strongly* recommend usage of an SSD disk for the build, since disk speed is
 106 one of the limiting factors for build performance.
 107 
 108 ### Building on x86
 109 
 110 At a minimum, a machine with 2-4 cores is advisable, as well as 2-4 GB of RAM.
 111 (The more cores to use, the more memory you need.) At least 6 GB of free disk
 112 space is required (8 GB minimum for building on Solaris).
 113 
 114 Even for 32-bit builds, it is recommended to use a 64-bit build machine, and
 115 instead create a 32-bit target using `--with-target-bits=32`.
 116 
 117 ### Building on sparc
 118 
 119 At a minimum, a machine with 4 cores is advisable, as well as 4 GB of RAM. (The
 120 more cores to use, the more memory you need.) At least 8 GB of free disk space
 121 is required.
 122 


 123 ### Building on aarch64
 124 
 125 At a minimum, a machine with 8 cores is advisable, as well as 8 GB of RAM.
 126 (The more cores to use, the more memory you need.) At least 6 GB of free disk
 127 space is required.
 128 
 129 If you do not have access to sufficiently powerful hardware, it is also
 130 possible to use [cross-compiling](#cross-compiling).
 131 
 132 ### Building on 32-bit arm
 133 
 134 This is not recommended. Instead, see the section on [Cross-compiling](
 135 #cross-compiling).
 136 
 137 ## Operating System Requirements
 138 
 139 The mainline JDK project supports Linux, Solaris, macOS, AIX and Windows.
 140 Support for other operating system, e.g. BSD, exists in separate &quot;port&quot;
 141 projects.
 142 
 143 In general, the JDK can be built on a wide range of versions of these operating
 144 systems, but the further you deviate from what is tested on a daily basis, the
 145 more likely you are to run into problems.
 146 
 147 This table lists the OS versions used by Oracle when building the JDK. Such
 148 information is always subject to change, but this table is up to date at the
 149 time of writing.
 150 
 151  Operating system   Vendor/version used
 152  -----------------  -------------------------------------------------------
<span class="line-modified"> 153  Linux              Oracle Enterprise Linux 6.4 / 7.1 (using kernel 3.8.13)</span>
<span class="line-modified"> 154  Solaris            Solaris 11.1 SRU 21.4.1 / 11.2 SRU 5.5</span>
<span class="line-modified"> 155  macOS              Mac OS X 10.9 (Mavericks) / 10.10 (Yosemite)</span>
 156  Windows            Windows Server 2012 R2
 157 
<span class="line-modified"> 158 The double version numbers for Linux, Solaris and macOS is due to the hybrid</span>
<span class="line-modified"> 159 model used at Oracle, where header files and external libraries from an older</span>
<span class="line-modified"> 160 version are used when building on a more modern version of the OS.</span>
 161 
 162 The Build Group has a wiki page with [Supported Build Platforms](
 163 https://wiki.openjdk.java.net/display/Build/Supported+Build+Platforms). From
 164 time to time, this is updated by contributors to list successes or failures of
 165 building on different platforms.
 166 
 167 ### Windows
 168 
 169 Windows XP is not a supported platform, but all newer Windows should be able to
 170 build the JDK.
 171 
 172 On Windows, it is important that you pay attention to the instructions in the
 173 [Special Considerations](#special-considerations).
 174 
 175 Windows is the only non-POSIX OS supported by the JDK, and as such, requires
 176 some extra care. A POSIX support layer is required to build on Windows.
 177 Currently, the only supported such layers are Cygwin and Windows Subsystem for
 178 Linux (WSL). (Msys is no longer supported due to a too old bash; msys2 would
 179 likely be possible to support in a future version but that would require effort
 180 to implement.)
</pre>
<hr />
<pre>
 241 /etc/fstab or /etc/wsl.conf in WSL. Individual directories may be corrected
 242 using the fsutil tool in case the source was cloned before changing the mount
 243 options.
 244 
 245 Note that while it&#39;s possible to build on WSL, testing is still not fully
 246 supported.
 247 
 248 ### Solaris
 249 
 250 See `make/devkit/solaris11.1-package-list.txt` for a list of recommended
 251 packages to install when building on Solaris. The versions specified in this
 252 list is the versions used by the daily builds at Oracle, and is likely to work
 253 properly.
 254 
 255 Older versions of Solaris shipped a broken version of `objcopy`. At least
 256 version 2.21.1 is needed, which is provided by Solaris 11 Update 1. Objcopy is
 257 needed if you want to have external debug symbols. Please make sure you are
 258 using at least version 2.21.1 of objcopy, or that you disable external debug
 259 symbols.
 260 


 261 ### macOS
 262 
 263 Apple is using a quite aggressive scheme of pushing OS updates, and coupling
 264 these updates with required updates of Xcode. Unfortunately, this makes it
 265 difficult for a project such as the JDK to keep pace with a continuously updated
 266 machine running macOS. See the section on [Apple Xcode](#apple-xcode) on some
 267 strategies to deal with this.
 268 
 269 It is recommended that you use at least Mac OS X 10.13 (High Sierra). At the time
 270 of writing, the JDK has been successfully compiled on macOS 10.12 (Sierra).
 271 
 272 The standard macOS environment contains the basic tooling needed to build, but
 273 for external libraries a package manager is recommended. The JDK uses
 274 [homebrew](https://brew.sh/) in the examples, but feel free to use whatever
 275 manager you want (or none).
 276 
 277 ### Linux
 278 
 279 It is often not much problem to build the JDK on Linux. The only general advice
 280 is to try to use the compilers, external libraries and header files as provided
</pre>
<hr />
<pre>
 306 system should be independent factors, but in practice there&#39;s more or less a
 307 one-to-one correlation between target operating system and toolchain.
 308 
 309  Operating system   Supported toolchain
 310  ------------------ -------------------------
 311  Linux              gcc, clang
 312  macOS              Apple Xcode (using clang)
 313  Solaris            Oracle Solaris Studio
 314  AIX                IBM XL C/C++
 315  Windows            Microsoft Visual Studio
 316 
 317 Please see the individual sections on the toolchains for version
 318 recommendations. As a reference, these versions of the toolchains are used, at
 319 the time of writing, by Oracle for the daily builds of the JDK. It should be
 320 possible to compile the JDK with both older and newer versions, but the closer
 321 you stay to this list, the more likely you are to compile successfully without
 322 issues.
 323 
 324  Operating system   Toolchain version
 325  ------------------ -------------------------------------------------------
<span class="line-modified"> 326  Linux              gcc 7.3.0</span>
<span class="line-modified"> 327  macOS              Apple Xcode 9.4 (using clang 9.1.0)</span>
<span class="line-modified"> 328  Solaris            Oracle Solaris Studio 12.4 (with compiler version 5.13)</span>
<span class="line-modified"> 329  Windows            Microsoft Visual Studio 2017 update 15.5.5</span>





 330 
 331 ### gcc
 332 
<span class="line-modified"> 333 The minimum accepted version of gcc is 4.8. Older versions will generate a warning</span>
 334 by `configure` and are unlikely to work.
 335 
<span class="line-modified"> 336 The JDK is currently known to be able to compile with at least version 7.4 of</span>
 337 gcc.
 338 
 339 In general, any version between these two should be usable.
 340 
 341 ### clang
 342 
 343 The minimum accepted version of clang is 3.2. Older versions will not be
 344 accepted by `configure`.
 345 
 346 To use clang instead of gcc on Linux, use `--with-toolchain-type=clang`.
 347 
 348 ### Apple Xcode
 349 
 350 The oldest supported version of Xcode is 8.
 351 
 352 You will need the Xcode command lines developers tools to be able to build
 353 the JDK. (Actually, *only* the command lines tools are needed, not the IDE.)
 354 The simplest way to install these is to run:
 355 ```
 356 xcode-select --install
</pre>
<hr />
<pre>
 387  developer/solarisstudio-124/library/math-libs      12.4-1.0.0.1
 388  developer/solarisstudio-124/library/studio-gccrt   12.4-1.0.0.1
 389  developer/solarisstudio-124/studio-common          12.4-1.0.0.1
 390  developer/solarisstudio-124/studio-ja              12.4-1.0.0.1
 391  developer/solarisstudio-124/studio-legal           12.4-1.0.0.1
 392  developer/solarisstudio-124/studio-zhCN            12.4-1.0.0.1
 393 
 394 Compiling with Solaris Studio can sometimes be finicky. This is the exact
 395 version used by Oracle, which worked correctly at the time of writing:
 396 ```
 397 $ cc -V
 398 cc: Sun C 5.13 SunOS_i386 2014/10/20
 399 $ CC -V
 400 CC: Sun C++ 5.13 SunOS_i386 151846-10 2015/10/30
 401 ```
 402 
 403 ### Microsoft Visual Studio
 404 
 405 The minimum accepted version of Visual Studio is 2010. Older versions will not
 406 be accepted by `configure`. The maximum accepted version of Visual Studio is
<span class="line-modified"> 407 2017. Versions older than 2017 are unlikely to continue working for long.</span>
 408 
 409 If you have multiple versions of Visual Studio installed, `configure` will by
 410 default pick the latest. You can request a specific version to be used by
 411 setting `--with-toolchain-version`, e.g. `--with-toolchain-version=2015`.
 412 
 413 If you get `LINK: fatal error LNK1123: failure during conversion to COFF: file
 414 invalid` when building using Visual Studio 2010, you have encountered
 415 [KB2757355](http://support.microsoft.com/kb/2757355), a bug triggered by a
 416 specific installation order. However, the solution suggested by the KB article
 417 does not always resolve the problem. See [this stackoverflow discussion](
 418 https://stackoverflow.com/questions/10888391) for other suggestions.
 419 
 420 ### IBM XL C/C++
 421 
 422 Please consult the AIX section of the [Supported Build Platforms](
 423 https://wiki.openjdk.java.net/display/Build/Supported+Build+Platforms) OpenJDK
 424 Build Wiki page for details about which versions of XLC are supported.
 425 
 426 
 427 ## Boot JDK Requirements
</pre>
<hr />
<pre>
 451 JDK binaries for Linux, Windows and macOS can be downloaded from
 452 [jdk.java.net](http://jdk.java.net). An alternative is to download the
 453 [Oracle JDK](http://www.oracle.com/technetwork/java/javase/downloads). Another
 454 is the [Adopt OpenJDK Project](https://adoptopenjdk.net/), which publishes
 455 experimental prebuilt binaries for various platforms.
 456 
 457 On Linux you can also get a JDK from the Linux distribution. On apt-based
 458 distros (like Debian and Ubuntu), `sudo apt-get install openjdk-&lt;VERSION&gt;-jdk`
 459 is typically enough to install a JDK \&lt;VERSION\&gt;. On rpm-based distros (like
 460 Fedora and Red Hat), try `sudo yum install java-&lt;VERSION&gt;-openjdk-devel`.
 461 
 462 ## External Library Requirements
 463 
 464 Different platforms require different external libraries. In general, libraries
 465 are not optional - that is, they are either required or not used.
 466 
 467 If a required library is not detected by `configure`, you need to provide the
 468 path to it. There are two forms of the `configure` arguments to point to an
 469 external library: `--with-&lt;LIB&gt;=&lt;path&gt;` or `--with-&lt;LIB&gt;-include=&lt;path to
 470 include&gt; --with-&lt;LIB&gt;-lib=&lt;path to lib&gt;`. The first variant is more concise,
<span class="line-modified"> 471 but require the include files an library files to reside in a default hierarchy</span>
<span class="line-modified"> 472 under this directory. In most cases, it works fine.</span>
 473 
 474 As a fallback, the second version allows you to point to the include directory
 475 and the lib directory separately.
 476 
 477 ### FreeType
 478 
 479 FreeType2 from [The FreeType Project](http://www.freetype.org/) is not required
 480 on any platform. The exception is on Unix-based platforms when configuring such
 481 that the build artifacts will reference a system installed library,
<span class="line-modified"> 482 rather than bundling the JDKâ€™s own copy.</span>
 483 
 484   * To install on an apt-based Linux, try running `sudo apt-get install
 485     libfreetype6-dev`.
 486   * To install on an rpm-based Linux, try running `sudo yum install
 487     freetype-devel`.
 488   * To install on Solaris, try running `pkg install system/library/freetype-2`.
 489 
 490 Use `--with-freetype-include=&lt;path&gt;` and `--with-freetype-lib=&lt;path&gt;`
 491 if `configure` does not automatically locate the platform FreeType files.
 492 
 493 ### CUPS
 494 
 495 CUPS, [Common UNIX Printing System](http://www.cups.org) header files are
 496 required on all platforms, except Windows. Often these files are provided by
 497 your operating system.
 498 
 499   * To install on an apt-based Linux, try running `sudo apt-get install
 500     libcups2-dev`.
 501   * To install on an rpm-based Linux, try running `sudo yum install
 502     cups-devel`.
</pre>
<hr />
<pre>
 601 The JDK requires [GNU Bash](http://www.gnu.org/software/bash). No other shells
 602 are supported.
 603 
 604 At least version 3.2 of GNU Bash must be used.
 605 
 606 ## Running Configure
 607 
 608 To build the JDK, you need a &quot;configuration&quot;, which consists of a directory
 609 where to store the build output, coupled with information about the platform,
 610 the specific build machine, and choices that affect how the JDK is built.
 611 
 612 The configuration is created by the `configure` script. The basic invocation of
 613 the `configure` script looks like this:
 614 
 615 ```
 616 bash configure [options]
 617 ```
 618 
 619 This will create an output directory containing the configuration and setup an
 620 area for the build result. This directory typically looks like
<span class="line-modified"> 621 `build/linux-x64-normal-server-release`, but the actual name depends on your</span>
<span class="line-modified"> 622 specific configuration. (It can also be set directly, see [Using Multiple</span>
 623 Configurations](#using-multiple-configurations)). This directory is referred to
 624 as `$BUILD` in this documentation.
 625 
 626 `configure` will try to figure out what system you are running on and where all
 627 necessary build components are. If you have all prerequisites for building
 628 installed, it should find everything. If it fails to detect any component
 629 automatically, it will exit and inform you about the problem.
 630 
 631 Some command line examples:
 632 
 633   * Create a 32-bit build for Windows with FreeType2 in `C:\freetype-i586`:
 634     ```
 635     bash configure --with-freetype=/cygdrive/c/freetype-i586 --with-target-bits=32
 636     ```
 637 
 638   * Create a debug build with the `server` JVM and DTrace enabled:
 639     ```
 640     bash configure --enable-debug --with-jvm-variants=server --enable-dtrace
 641     ```
 642 
</pre>
<hr />
<pre>
 705     files
 706   * `--with-extra-cxxflags=&lt;flags&gt;` - Append these flags when compiling JDK C++
 707     files
 708   * `--with-extra-ldflags=&lt;flags&gt;` - Append these flags when linking JDK
 709     libraries
 710 
 711 #### Configure Arguments for External Dependencies
 712 
 713   * `--with-boot-jdk=&lt;path&gt;` - Set the path to the [Boot JDK](
 714     #boot-jdk-requirements)
 715   * `--with-freetype=&lt;path&gt;` - Set the path to [FreeType](#freetype)
 716   * `--with-cups=&lt;path&gt;` - Set the path to [CUPS](#cups)
 717   * `--with-x=&lt;path&gt;` - Set the path to [X11](#x11)
 718   * `--with-alsa=&lt;path&gt;` - Set the path to [ALSA](#alsa)
 719   * `--with-libffi=&lt;path&gt;` - Set the path to [libffi](#libffi)
 720   * `--with-jtreg=&lt;path&gt;` - Set the path to JTReg. See [Running Tests](
 721     #running-tests)
 722 
 723 Certain third-party libraries used by the JDK (libjpeg, giflib, libpng, lcms
 724 and zlib) are included in the JDK repository. The default behavior of the
<span class="line-modified"> 725 JDK build is to use this version of these libraries, but they might be</span>
<span class="line-modified"> 726 replaced by an external version. To do so, specify `system` as the `&lt;source&gt;`</span>
<span class="line-modified"> 727 option in these arguments. (The default is `bundled`).</span>



 728 
 729   * `--with-libjpeg=&lt;source&gt;` - Use the specified source for libjpeg
 730   * `--with-giflib=&lt;source&gt;` - Use the specified source for giflib
 731   * `--with-libpng=&lt;source&gt;` - Use the specified source for libpng
 732   * `--with-lcms=&lt;source&gt;` - Use the specified source for lcms
 733   * `--with-zlib=&lt;source&gt;` - Use the specified source for zlib
 734 
 735 On Linux, it is possible to select either static or dynamic linking of the C++
 736 runtime. The default is static linking, with dynamic linking as fallback if the
 737 static library is not found.
 738 
 739   * `--with-stdc++lib=&lt;method&gt;` - Use the specified method (`static`, `dynamic`
 740     or `default`) for linking the C++ runtime.
 741 
 742 ### Configure Control Variables
 743 
 744 It is possible to control certain aspects of `configure` by overriding the
 745 value of `configure` variables, either on the command line or in the
 746 environment.
 747 
</pre>
<hr />
<pre>
 846 #### Test Make Control Variables
 847 
 848 These make control variables only make sense when running tests. Please see
 849 [Testing the JDK](testing.html) for details.
 850 
 851   * `TEST`
 852   * `TEST_JOBS`
 853   * `JTREG`
 854   * `GTEST`
 855 
 856 #### Advanced Make Control Variables
 857 
 858 These advanced make control variables can be potentially unsafe. See [Hints and
 859 Suggestions for Advanced Users](#hints-and-suggestions-for-advanced-users) and
 860 [Understanding the Build System](#understanding-the-build-system) for details.
 861 
 862   * `SPEC`
 863   * `CONF_CHECK`
 864   * `COMPARE_BUILD`
 865   * `JDK_FILTER`

 866 
 867 ## Running Tests
 868 
 869 Most of the JDK tests are using the [JTReg](http://openjdk.java.net/jtreg)
 870 test framework. Make sure that your configuration knows where to find your
 871 installation of JTReg. If this is not picked up automatically, use the
 872 `--with-jtreg=&lt;path to jtreg home&gt;` option to point to the JTReg framework.
 873 Note that this option should point to the JTReg home, i.e. the top directory,
 874 containing `lib/jtreg.jar` etc.
 875 
 876 The [Adoption Group](https://wiki.openjdk.java.net/display/Adoption) provides
 877 recent builds of jtreg [here](
 878 https://adopt-openjdk.ci.cloudbees.com/job/jtreg/lastSuccessfulBuild/artifact).
 879 Download the latest `.tar.gz` file, unpack it, and point `--with-jtreg` to the
 880 `jtreg` directory that you just unpacked.
 881 
 882 To execute the most basic tests (tier 1), use:
 883 ```
 884 make run-test-tier1
 885 ```
</pre>
<hr />
<pre>
1008 generates output that can run on the build system (the *build* toolchain). Note
1009 that cross-compiling is only supported for gcc at the time being. The gcc
1010 standard is to prefix cross-compiling toolchains with the target denominator.
1011 If you follow this standard, `configure` is likely to pick up the toolchain
1012 correctly.
1013 
1014 The *build* toolchain will be autodetected just the same way the normal
1015 *build*/*target* toolchain will be autodetected when not cross-compiling. If
1016 this is not what you want, or if the autodetection fails, you can specify a
1017 devkit containing the *build* toolchain using `--with-build-devkit` to
1018 `configure`, or by giving `BUILD_CC` and `BUILD_CXX` arguments.
1019 
1020 It is often helpful to locate the cross-compilation tools, headers and
1021 libraries in a separate directory, outside the normal path, and point out that
1022 directory to `configure`. Do this by setting the sysroot (`--with-sysroot`) and
1023 appending the directory when searching for cross-compilations tools
1024 (`--with-toolchain-path`). As a compact form, you can also use `--with-devkit`
1025 to point to a single directory, if it is correctly setup. (See `basics.m4` for
1026 details.)
1027 
<span class="line-removed">1028 If you are unsure what toolchain and versions to use, these have been proved</span>
<span class="line-removed">1029 working at the time of writing:</span>
<span class="line-removed">1030 </span>
<span class="line-removed">1031   * [aarch64](</span>
<span class="line-removed">1032 https://releases.linaro.org/archive/13.11/components/toolchain/binaries/gcc-linaro-aarch64-linux-gnu-4.8-2013.11_linux.tar.xz)</span>
<span class="line-removed">1033   * [arm 32-bit hardware floating  point](</span>
<span class="line-removed">1034 https://launchpad.net/linaro-toolchain-unsupported/trunk/2012.09/+download/gcc-linaro-arm-linux-gnueabihf-raspbian-2012.09-20120921_linux.tar.bz2)</span>
<span class="line-removed">1035 </span>
1036 ### Native Libraries
1037 
1038 You will need copies of external native libraries for the *target* system,
1039 present on the *build* machine while building.
1040 
1041 Take care not to replace the *build* system&#39;s version of these libraries by
1042 mistake, since that can render the *build* machine unusable.
1043 
1044 Make sure that the libraries you point to (ALSA, X11, etc) are for the
1045 *target*, not the *build*, platform.
1046 
1047 #### ALSA
1048 
1049 You will need alsa libraries suitable for your *target* system. For most cases,
1050 using Debian&#39;s pre-built libraries work fine.
1051 
1052 Note that alsa is needed even if you only want to build a headless JDK.
1053 
1054   * Go to [Debian Package Search](https://www.debian.org/distrib/packages) and
1055     search for the `libasound2` and `libasound2-dev` packages for your *target*
</pre>
</td>
<td>
<hr />
<pre>
 103 complete a build at all.
 104 
 105 We *strongly* recommend usage of an SSD disk for the build, since disk speed is
 106 one of the limiting factors for build performance.
 107 
 108 ### Building on x86
 109 
 110 At a minimum, a machine with 2-4 cores is advisable, as well as 2-4 GB of RAM.
 111 (The more cores to use, the more memory you need.) At least 6 GB of free disk
 112 space is required (8 GB minimum for building on Solaris).
 113 
 114 Even for 32-bit builds, it is recommended to use a 64-bit build machine, and
 115 instead create a 32-bit target using `--with-target-bits=32`.
 116 
 117 ### Building on sparc
 118 
 119 At a minimum, a machine with 4 cores is advisable, as well as 4 GB of RAM. (The
 120 more cores to use, the more memory you need.) At least 8 GB of free disk space
 121 is required.
 122 
<span class="line-added"> 123 Note: The sparc port is deprecated.</span>
<span class="line-added"> 124 </span>
 125 ### Building on aarch64
 126 
 127 At a minimum, a machine with 8 cores is advisable, as well as 8 GB of RAM.
 128 (The more cores to use, the more memory you need.) At least 6 GB of free disk
 129 space is required.
 130 
 131 If you do not have access to sufficiently powerful hardware, it is also
 132 possible to use [cross-compiling](#cross-compiling).
 133 
 134 ### Building on 32-bit arm
 135 
 136 This is not recommended. Instead, see the section on [Cross-compiling](
 137 #cross-compiling).
 138 
 139 ## Operating System Requirements
 140 
 141 The mainline JDK project supports Linux, Solaris, macOS, AIX and Windows.
 142 Support for other operating system, e.g. BSD, exists in separate &quot;port&quot;
 143 projects.
 144 
 145 In general, the JDK can be built on a wide range of versions of these operating
 146 systems, but the further you deviate from what is tested on a daily basis, the
 147 more likely you are to run into problems.
 148 
 149 This table lists the OS versions used by Oracle when building the JDK. Such
 150 information is always subject to change, but this table is up to date at the
 151 time of writing.
 152 
 153  Operating system   Vendor/version used
 154  -----------------  -------------------------------------------------------
<span class="line-modified"> 155  Linux              Oracle Enterprise Linux 6.4 / 7.6</span>
<span class="line-modified"> 156  Solaris            Solaris 11.3 SRU 20</span>
<span class="line-modified"> 157  macOS              Mac OS X 10.13 (High Sierra)</span>
 158  Windows            Windows Server 2012 R2
 159 
<span class="line-modified"> 160 The double version numbers for Linux and Solaris are due to the hybrid model</span>
<span class="line-modified"> 161 used at Oracle, where header files and external libraries from an older version</span>
<span class="line-modified"> 162 are used when building on a more modern version of the OS.</span>
 163 
 164 The Build Group has a wiki page with [Supported Build Platforms](
 165 https://wiki.openjdk.java.net/display/Build/Supported+Build+Platforms). From
 166 time to time, this is updated by contributors to list successes or failures of
 167 building on different platforms.
 168 
 169 ### Windows
 170 
 171 Windows XP is not a supported platform, but all newer Windows should be able to
 172 build the JDK.
 173 
 174 On Windows, it is important that you pay attention to the instructions in the
 175 [Special Considerations](#special-considerations).
 176 
 177 Windows is the only non-POSIX OS supported by the JDK, and as such, requires
 178 some extra care. A POSIX support layer is required to build on Windows.
 179 Currently, the only supported such layers are Cygwin and Windows Subsystem for
 180 Linux (WSL). (Msys is no longer supported due to a too old bash; msys2 would
 181 likely be possible to support in a future version but that would require effort
 182 to implement.)
</pre>
<hr />
<pre>
 243 /etc/fstab or /etc/wsl.conf in WSL. Individual directories may be corrected
 244 using the fsutil tool in case the source was cloned before changing the mount
 245 options.
 246 
 247 Note that while it&#39;s possible to build on WSL, testing is still not fully
 248 supported.
 249 
 250 ### Solaris
 251 
 252 See `make/devkit/solaris11.1-package-list.txt` for a list of recommended
 253 packages to install when building on Solaris. The versions specified in this
 254 list is the versions used by the daily builds at Oracle, and is likely to work
 255 properly.
 256 
 257 Older versions of Solaris shipped a broken version of `objcopy`. At least
 258 version 2.21.1 is needed, which is provided by Solaris 11 Update 1. Objcopy is
 259 needed if you want to have external debug symbols. Please make sure you are
 260 using at least version 2.21.1 of objcopy, or that you disable external debug
 261 symbols.
 262 
<span class="line-added"> 263 Note: The Solaris port is deprecated.</span>
<span class="line-added"> 264 </span>
 265 ### macOS
 266 
 267 Apple is using a quite aggressive scheme of pushing OS updates, and coupling
 268 these updates with required updates of Xcode. Unfortunately, this makes it
 269 difficult for a project such as the JDK to keep pace with a continuously updated
 270 machine running macOS. See the section on [Apple Xcode](#apple-xcode) on some
 271 strategies to deal with this.
 272 
 273 It is recommended that you use at least Mac OS X 10.13 (High Sierra). At the time
 274 of writing, the JDK has been successfully compiled on macOS 10.12 (Sierra).
 275 
 276 The standard macOS environment contains the basic tooling needed to build, but
 277 for external libraries a package manager is recommended. The JDK uses
 278 [homebrew](https://brew.sh/) in the examples, but feel free to use whatever
 279 manager you want (or none).
 280 
 281 ### Linux
 282 
 283 It is often not much problem to build the JDK on Linux. The only general advice
 284 is to try to use the compilers, external libraries and header files as provided
</pre>
<hr />
<pre>
 310 system should be independent factors, but in practice there&#39;s more or less a
 311 one-to-one correlation between target operating system and toolchain.
 312 
 313  Operating system   Supported toolchain
 314  ------------------ -------------------------
 315  Linux              gcc, clang
 316  macOS              Apple Xcode (using clang)
 317  Solaris            Oracle Solaris Studio
 318  AIX                IBM XL C/C++
 319  Windows            Microsoft Visual Studio
 320 
 321 Please see the individual sections on the toolchains for version
 322 recommendations. As a reference, these versions of the toolchains are used, at
 323 the time of writing, by Oracle for the daily builds of the JDK. It should be
 324 possible to compile the JDK with both older and newer versions, but the closer
 325 you stay to this list, the more likely you are to compile successfully without
 326 issues.
 327 
 328  Operating system   Toolchain version
 329  ------------------ -------------------------------------------------------
<span class="line-modified"> 330  Linux              gcc 8.3.0</span>
<span class="line-modified"> 331  macOS              Apple Xcode 10.1 (using clang 10.0.0)</span>
<span class="line-modified"> 332  Solaris            Oracle Solaris Studio 12.6 (with compiler version 5.15)</span>
<span class="line-modified"> 333  Windows            Microsoft Visual Studio 2017 update 15.9.16</span>
<span class="line-added"> 334 </span>
<span class="line-added"> 335 All compilers are expected to be able to compile to the C99 language standard,</span>
<span class="line-added"> 336 as some C99 features are used in the source code. Microsoft Visual Studio</span>
<span class="line-added"> 337 doesn&#39;t fully support C99 so in practice shared code is limited to using C99</span>
<span class="line-added"> 338 features that it does support.</span>
 339 
 340 ### gcc
 341 
<span class="line-modified"> 342 The minimum accepted version of gcc is 5.0. Older versions will generate a warning</span>
 343 by `configure` and are unlikely to work.
 344 
<span class="line-modified"> 345 The JDK is currently known to be able to compile with at least version 8.3 of</span>
 346 gcc.
 347 
 348 In general, any version between these two should be usable.
 349 
 350 ### clang
 351 
 352 The minimum accepted version of clang is 3.2. Older versions will not be
 353 accepted by `configure`.
 354 
 355 To use clang instead of gcc on Linux, use `--with-toolchain-type=clang`.
 356 
 357 ### Apple Xcode
 358 
 359 The oldest supported version of Xcode is 8.
 360 
 361 You will need the Xcode command lines developers tools to be able to build
 362 the JDK. (Actually, *only* the command lines tools are needed, not the IDE.)
 363 The simplest way to install these is to run:
 364 ```
 365 xcode-select --install
</pre>
<hr />
<pre>
 396  developer/solarisstudio-124/library/math-libs      12.4-1.0.0.1
 397  developer/solarisstudio-124/library/studio-gccrt   12.4-1.0.0.1
 398  developer/solarisstudio-124/studio-common          12.4-1.0.0.1
 399  developer/solarisstudio-124/studio-ja              12.4-1.0.0.1
 400  developer/solarisstudio-124/studio-legal           12.4-1.0.0.1
 401  developer/solarisstudio-124/studio-zhCN            12.4-1.0.0.1
 402 
 403 Compiling with Solaris Studio can sometimes be finicky. This is the exact
 404 version used by Oracle, which worked correctly at the time of writing:
 405 ```
 406 $ cc -V
 407 cc: Sun C 5.13 SunOS_i386 2014/10/20
 408 $ CC -V
 409 CC: Sun C++ 5.13 SunOS_i386 151846-10 2015/10/30
 410 ```
 411 
 412 ### Microsoft Visual Studio
 413 
 414 The minimum accepted version of Visual Studio is 2010. Older versions will not
 415 be accepted by `configure`. The maximum accepted version of Visual Studio is
<span class="line-modified"> 416 2019. Versions older than 2017 are unlikely to continue working for long.</span>
 417 
 418 If you have multiple versions of Visual Studio installed, `configure` will by
 419 default pick the latest. You can request a specific version to be used by
 420 setting `--with-toolchain-version`, e.g. `--with-toolchain-version=2015`.
 421 
 422 If you get `LINK: fatal error LNK1123: failure during conversion to COFF: file
 423 invalid` when building using Visual Studio 2010, you have encountered
 424 [KB2757355](http://support.microsoft.com/kb/2757355), a bug triggered by a
 425 specific installation order. However, the solution suggested by the KB article
 426 does not always resolve the problem. See [this stackoverflow discussion](
 427 https://stackoverflow.com/questions/10888391) for other suggestions.
 428 
 429 ### IBM XL C/C++
 430 
 431 Please consult the AIX section of the [Supported Build Platforms](
 432 https://wiki.openjdk.java.net/display/Build/Supported+Build+Platforms) OpenJDK
 433 Build Wiki page for details about which versions of XLC are supported.
 434 
 435 
 436 ## Boot JDK Requirements
</pre>
<hr />
<pre>
 460 JDK binaries for Linux, Windows and macOS can be downloaded from
 461 [jdk.java.net](http://jdk.java.net). An alternative is to download the
 462 [Oracle JDK](http://www.oracle.com/technetwork/java/javase/downloads). Another
 463 is the [Adopt OpenJDK Project](https://adoptopenjdk.net/), which publishes
 464 experimental prebuilt binaries for various platforms.
 465 
 466 On Linux you can also get a JDK from the Linux distribution. On apt-based
 467 distros (like Debian and Ubuntu), `sudo apt-get install openjdk-&lt;VERSION&gt;-jdk`
 468 is typically enough to install a JDK \&lt;VERSION\&gt;. On rpm-based distros (like
 469 Fedora and Red Hat), try `sudo yum install java-&lt;VERSION&gt;-openjdk-devel`.
 470 
 471 ## External Library Requirements
 472 
 473 Different platforms require different external libraries. In general, libraries
 474 are not optional - that is, they are either required or not used.
 475 
 476 If a required library is not detected by `configure`, you need to provide the
 477 path to it. There are two forms of the `configure` arguments to point to an
 478 external library: `--with-&lt;LIB&gt;=&lt;path&gt;` or `--with-&lt;LIB&gt;-include=&lt;path to
 479 include&gt; --with-&lt;LIB&gt;-lib=&lt;path to lib&gt;`. The first variant is more concise,
<span class="line-modified"> 480 but require the include files and library files to reside in a default</span>
<span class="line-modified"> 481 hierarchy under this directory. In most cases, it works fine.</span>
 482 
 483 As a fallback, the second version allows you to point to the include directory
 484 and the lib directory separately.
 485 
 486 ### FreeType
 487 
 488 FreeType2 from [The FreeType Project](http://www.freetype.org/) is not required
 489 on any platform. The exception is on Unix-based platforms when configuring such
 490 that the build artifacts will reference a system installed library,
<span class="line-modified"> 491 rather than bundling the JDK&#39;s own copy.</span>
 492 
 493   * To install on an apt-based Linux, try running `sudo apt-get install
 494     libfreetype6-dev`.
 495   * To install on an rpm-based Linux, try running `sudo yum install
 496     freetype-devel`.
 497   * To install on Solaris, try running `pkg install system/library/freetype-2`.
 498 
 499 Use `--with-freetype-include=&lt;path&gt;` and `--with-freetype-lib=&lt;path&gt;`
 500 if `configure` does not automatically locate the platform FreeType files.
 501 
 502 ### CUPS
 503 
 504 CUPS, [Common UNIX Printing System](http://www.cups.org) header files are
 505 required on all platforms, except Windows. Often these files are provided by
 506 your operating system.
 507 
 508   * To install on an apt-based Linux, try running `sudo apt-get install
 509     libcups2-dev`.
 510   * To install on an rpm-based Linux, try running `sudo yum install
 511     cups-devel`.
</pre>
<hr />
<pre>
 610 The JDK requires [GNU Bash](http://www.gnu.org/software/bash). No other shells
 611 are supported.
 612 
 613 At least version 3.2 of GNU Bash must be used.
 614 
 615 ## Running Configure
 616 
 617 To build the JDK, you need a &quot;configuration&quot;, which consists of a directory
 618 where to store the build output, coupled with information about the platform,
 619 the specific build machine, and choices that affect how the JDK is built.
 620 
 621 The configuration is created by the `configure` script. The basic invocation of
 622 the `configure` script looks like this:
 623 
 624 ```
 625 bash configure [options]
 626 ```
 627 
 628 This will create an output directory containing the configuration and setup an
 629 area for the build result. This directory typically looks like
<span class="line-modified"> 630 `build/linux-x64-server-release`, but the actual name depends on your specific</span>
<span class="line-modified"> 631 configuration. (It can also be set directly, see [Using Multiple</span>
 632 Configurations](#using-multiple-configurations)). This directory is referred to
 633 as `$BUILD` in this documentation.
 634 
 635 `configure` will try to figure out what system you are running on and where all
 636 necessary build components are. If you have all prerequisites for building
 637 installed, it should find everything. If it fails to detect any component
 638 automatically, it will exit and inform you about the problem.
 639 
 640 Some command line examples:
 641 
 642   * Create a 32-bit build for Windows with FreeType2 in `C:\freetype-i586`:
 643     ```
 644     bash configure --with-freetype=/cygdrive/c/freetype-i586 --with-target-bits=32
 645     ```
 646 
 647   * Create a debug build with the `server` JVM and DTrace enabled:
 648     ```
 649     bash configure --enable-debug --with-jvm-variants=server --enable-dtrace
 650     ```
 651 
</pre>
<hr />
<pre>
 714     files
 715   * `--with-extra-cxxflags=&lt;flags&gt;` - Append these flags when compiling JDK C++
 716     files
 717   * `--with-extra-ldflags=&lt;flags&gt;` - Append these flags when linking JDK
 718     libraries
 719 
 720 #### Configure Arguments for External Dependencies
 721 
 722   * `--with-boot-jdk=&lt;path&gt;` - Set the path to the [Boot JDK](
 723     #boot-jdk-requirements)
 724   * `--with-freetype=&lt;path&gt;` - Set the path to [FreeType](#freetype)
 725   * `--with-cups=&lt;path&gt;` - Set the path to [CUPS](#cups)
 726   * `--with-x=&lt;path&gt;` - Set the path to [X11](#x11)
 727   * `--with-alsa=&lt;path&gt;` - Set the path to [ALSA](#alsa)
 728   * `--with-libffi=&lt;path&gt;` - Set the path to [libffi](#libffi)
 729   * `--with-jtreg=&lt;path&gt;` - Set the path to JTReg. See [Running Tests](
 730     #running-tests)
 731 
 732 Certain third-party libraries used by the JDK (libjpeg, giflib, libpng, lcms
 733 and zlib) are included in the JDK repository. The default behavior of the
<span class="line-modified"> 734 JDK build is to use the included (&quot;bundled&quot;) versions of libjpeg, giflib,</span>
<span class="line-modified"> 735 libpng and lcms.</span>
<span class="line-modified"> 736 For zlib, the system lib (if present) is used except on Windows and AIX.</span>
<span class="line-added"> 737 However the bundled libraries may be replaced by an external version.</span>
<span class="line-added"> 738 To do so, specify `system` as the `&lt;source&gt;` option in these arguments.</span>
<span class="line-added"> 739 (The default is `bundled`).</span>
 740 
 741   * `--with-libjpeg=&lt;source&gt;` - Use the specified source for libjpeg
 742   * `--with-giflib=&lt;source&gt;` - Use the specified source for giflib
 743   * `--with-libpng=&lt;source&gt;` - Use the specified source for libpng
 744   * `--with-lcms=&lt;source&gt;` - Use the specified source for lcms
 745   * `--with-zlib=&lt;source&gt;` - Use the specified source for zlib
 746 
 747 On Linux, it is possible to select either static or dynamic linking of the C++
 748 runtime. The default is static linking, with dynamic linking as fallback if the
 749 static library is not found.
 750 
 751   * `--with-stdc++lib=&lt;method&gt;` - Use the specified method (`static`, `dynamic`
 752     or `default`) for linking the C++ runtime.
 753 
 754 ### Configure Control Variables
 755 
 756 It is possible to control certain aspects of `configure` by overriding the
 757 value of `configure` variables, either on the command line or in the
 758 environment.
 759 
</pre>
<hr />
<pre>
 858 #### Test Make Control Variables
 859 
 860 These make control variables only make sense when running tests. Please see
 861 [Testing the JDK](testing.html) for details.
 862 
 863   * `TEST`
 864   * `TEST_JOBS`
 865   * `JTREG`
 866   * `GTEST`
 867 
 868 #### Advanced Make Control Variables
 869 
 870 These advanced make control variables can be potentially unsafe. See [Hints and
 871 Suggestions for Advanced Users](#hints-and-suggestions-for-advanced-users) and
 872 [Understanding the Build System](#understanding-the-build-system) for details.
 873 
 874   * `SPEC`
 875   * `CONF_CHECK`
 876   * `COMPARE_BUILD`
 877   * `JDK_FILTER`
<span class="line-added"> 878   * `SPEC_FILTER`</span>
 879 
 880 ## Running Tests
 881 
 882 Most of the JDK tests are using the [JTReg](http://openjdk.java.net/jtreg)
 883 test framework. Make sure that your configuration knows where to find your
 884 installation of JTReg. If this is not picked up automatically, use the
 885 `--with-jtreg=&lt;path to jtreg home&gt;` option to point to the JTReg framework.
 886 Note that this option should point to the JTReg home, i.e. the top directory,
 887 containing `lib/jtreg.jar` etc.
 888 
 889 The [Adoption Group](https://wiki.openjdk.java.net/display/Adoption) provides
 890 recent builds of jtreg [here](
 891 https://adopt-openjdk.ci.cloudbees.com/job/jtreg/lastSuccessfulBuild/artifact).
 892 Download the latest `.tar.gz` file, unpack it, and point `--with-jtreg` to the
 893 `jtreg` directory that you just unpacked.
 894 
 895 To execute the most basic tests (tier 1), use:
 896 ```
 897 make run-test-tier1
 898 ```
</pre>
<hr />
<pre>
1021 generates output that can run on the build system (the *build* toolchain). Note
1022 that cross-compiling is only supported for gcc at the time being. The gcc
1023 standard is to prefix cross-compiling toolchains with the target denominator.
1024 If you follow this standard, `configure` is likely to pick up the toolchain
1025 correctly.
1026 
1027 The *build* toolchain will be autodetected just the same way the normal
1028 *build*/*target* toolchain will be autodetected when not cross-compiling. If
1029 this is not what you want, or if the autodetection fails, you can specify a
1030 devkit containing the *build* toolchain using `--with-build-devkit` to
1031 `configure`, or by giving `BUILD_CC` and `BUILD_CXX` arguments.
1032 
1033 It is often helpful to locate the cross-compilation tools, headers and
1034 libraries in a separate directory, outside the normal path, and point out that
1035 directory to `configure`. Do this by setting the sysroot (`--with-sysroot`) and
1036 appending the directory when searching for cross-compilations tools
1037 (`--with-toolchain-path`). As a compact form, you can also use `--with-devkit`
1038 to point to a single directory, if it is correctly setup. (See `basics.m4` for
1039 details.)
1040 








1041 ### Native Libraries
1042 
1043 You will need copies of external native libraries for the *target* system,
1044 present on the *build* machine while building.
1045 
1046 Take care not to replace the *build* system&#39;s version of these libraries by
1047 mistake, since that can render the *build* machine unusable.
1048 
1049 Make sure that the libraries you point to (ALSA, X11, etc) are for the
1050 *target*, not the *build*, platform.
1051 
1052 #### ALSA
1053 
1054 You will need alsa libraries suitable for your *target* system. For most cases,
1055 using Debian&#39;s pre-built libraries work fine.
1056 
1057 Note that alsa is needed even if you only want to build a headless JDK.
1058 
1059   * Go to [Debian Package Search](https://www.debian.org/distrib/packages) and
1060     search for the `libasound2` and `libasound2-dev` packages for your *target*
</pre>
</td>
</tr>
</table>
<center><a href="building.html.sdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="testing.html.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>